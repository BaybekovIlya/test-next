(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{3924:(e,a,t)=>{Promise.resolve().then(t.bind(t,9095))},7609:e=>{e.exports={loader:"Loader_loader__dFQzP",spin:"Loader_spin__11Ai7","loader-container":"Loader_loader-container__s8kNB"}},8109:(e,a,t)=>{"use strict";t.d(a,{A:()=>n});var s=t(5155);t(2115);var l=t(7609),r=t.n(l);let n=()=>(0,s.jsx)("div",{className:r()["loader-container"],children:(0,s.jsx)("div",{className:r().loader})})},9095:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>g});var s=t(5155),l=t(2115),r=t(5695),n=t(7383);let c=e=>{let{balance:a,currency:t,transactionsCount:l,lastTransactionDate:r}=e;return(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-600 mb-2",children:"Текущий баланс"}),(0,s.jsxs)("p",{className:"text-2xl font-bold text-black",children:[a," ",t]})]}),(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-600 mb-2",children:"Количество транзакций"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-black",children:l})]}),(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-600 mb-2",children:"Последняя транзакция"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-black",children:r})]})]})};var i=t(4731),o=t(2502),d=t(4065);let x=()=>{let[e,a]=(0,l.useState)(null);return o.t1.register(o.PP,o.kc,o.E8,o.hE,o.m_,o.s$),(0,l.useEffect)(()=>{a({labels:["Янв","Фев","Мар","Апр","Май","Июн"],datasets:[{label:"Транзакции",data:Array(6).fill().map(()=>i.a.number.int({min:10,max:100})),backgroundColor:"rgba(59, 130, 246, 0.6)",borderColor:"rgba(59, 130, 246, 1)",borderWidth:1},{label:"Платежи",data:Array(6).fill().map(()=>i.a.number.int({min:5,max:80})),backgroundColor:"rgba(16, 185, 129, 0.6)",borderColor:"rgba(16, 185, 129, 1)",borderWidth:1}]})},[]),(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow mb-8",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"График активности"}),(0,s.jsx)("div",{className:"h-50 sm:h-80 md:h-100",children:e&&(0,s.jsx)(d.yP,{options:{responsive:!0,plugins:{legend:{position:"top"},title:{display:!0,text:"Активность за последние 6 месяцев"}}},data:e})})]})},m=e=>{let{balance:a,currency:t,onWithdraw:r}=e,[n,c]=(0,l.useState)(""),[i,o]=(0,l.useState)("");return(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Вывод средств"}),(0,s.jsx)("form",{onSubmit:e=>{e.preventDefault();let t=parseFloat(n),s=parseFloat(a);if(!n){o("Введите сумму для вывода");return}switch(!0){case isNaN(t):o("Введите корректную сумму");return;case t>s:o("Недостаточно средств на балансе");return;case t<=0:o("Сумма должна быть больше нуля");return}r(t),c(""),o("")},children:(0,s.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,s.jsxs)("div",{className:"flex-grow",children:[(0,s.jsxs)("label",{className:"block text-gray-700 mb-2",htmlFor:"withdrawAmount",children:["Сумма для вывода (",t,")"]}),(0,s.jsx)("input",{id:"withdrawAmount",type:"number",className:"w-full px-3 py-2 border rounded-lg text-black",value:n,onChange:e=>c(e.target.value),placeholder:"Введите сумму",step:"0.01",min:"0"}),i&&(0,s.jsx)("p",{className:"text-red-500 mt-2",children:i})]}),(0,s.jsx)("div",{className:"flex items-end",children:(0,s.jsx)("button",{type:"submit",className:"px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition cursor-pointer",children:"Вывести баланс"})})]})})]})},u=()=>({balance:i.a.finance.amount({min:1e3,max:1e4,dec:2}),transactionsCount:i.a.number.int({min:5,max:50}),lastTransactionDate:i.a.date.recent().toLocaleDateString(),currency:"USD"}),h=()=>{let[e,a]=(0,l.useState)(null),[t,s]=(0,l.useState)(!0);return(0,l.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/dashboard");if(e.ok){let t=await e.json();a(t)}else a(u())}catch(e){console.error("Ошибка загрузки данных:",e)}finally{s(!1)}})()},[]),{dashboardData:e,setDashboardData:a,loading:t}};var b=t(8109);function g(){let[e,a]=(0,l.useState)(!0),t=(0,r.useRouter)(),{dashboardData:i,setDashboardData:o,loading:d}=h();return((0,l.useEffect)(()=>{n.A.get("auth_token")?a(!1):t.push("/login?redirect=/dashboard")},[t]),d||!i)?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center text-black",children:(0,s.jsx)("div",{className:"text-xl",children:(0,s.jsx)(b.A,{})})}):(0,s.jsx)(s.Fragment,{children:!e&&(0,s.jsx)("section",{className:"min-h-screen py-12",children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto px-4",children:[(0,s.jsxs)("div",{className:"flex gap-2 justify-between",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-8",children:"Дашборд"}),(0,s.jsx)("div",{children:(0,s.jsx)("button",{className:"px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition cursor-pointer",onClick:()=>t.push("/"),children:"Вернуться к профилю"})})]}),(0,s.jsx)(c,{balance:i.balance,currency:i.currency,lastTransactionDate:i.lastTransactionDate,transactionsCount:i.transactionsCount}),(0,s.jsx)(x,{}),(0,s.jsx)(m,{balance:i.balance,currency:i.currency,onWithdraw:e=>{if(!i)return;let a=parseFloat(i.balance),t=i.transactionsCount;alert("Вывод успешный: ".concat(e," ").concat(i.currency)),o({...i,balance:(a-e).toFixed(2),transactionsCount:t+1,lastTransactionDate:new Date().toLocaleDateString()})}})]})})})}}},e=>{var a=a=>e(e.s=a);e.O(0,[438,13,498,647,115,401,441,684,358],()=>a(3924)),_N_E=e.O()}]);